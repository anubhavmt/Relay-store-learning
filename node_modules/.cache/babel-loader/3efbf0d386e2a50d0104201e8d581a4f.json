{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"/Users/anubhavgupta/Documents/react_learning/graphql-react/relay-store-learning/node_modules/@babel/runtime/regenerator/index.js\");\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.RRNLAuthMiddlewareError = void 0;\nexports[\"default\"] = authMiddleware;\n\nvar _utils = require(\"../utils\");\n\nvar _RRNLError2 = _interopRequireDefault(require(\"../RRNLError\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nvar RRNLAuthMiddlewareError = /*#__PURE__*/function (_RRNLError) {\n  _inherits(RRNLAuthMiddlewareError, _RRNLError);\n\n  var _super = _createSuper(RRNLAuthMiddlewareError);\n\n  function RRNLAuthMiddlewareError(msg) {\n    var _this;\n\n    _classCallCheck(this, RRNLAuthMiddlewareError);\n\n    _this = _super.call(this, msg);\n    _this.name = 'RRNLAuthMiddlewareError';\n    return _this;\n  }\n\n  return RRNLAuthMiddlewareError;\n}(_RRNLError2[\"default\"]);\n\nexports.RRNLAuthMiddlewareError = RRNLAuthMiddlewareError;\n\nfunction authMiddleware(opts) {\n  var _ref = opts || {},\n      tokenOrThunk = _ref.token,\n      tokenRefreshPromise = _ref.tokenRefreshPromise,\n      _ref$allowEmptyToken = _ref.allowEmptyToken,\n      allowEmptyToken = _ref$allowEmptyToken === void 0 ? false : _ref$allowEmptyToken,\n      _ref$prefix = _ref.prefix,\n      prefix = _ref$prefix === void 0 ? 'Bearer ' : _ref$prefix,\n      _ref$header = _ref.header,\n      header = _ref$header === void 0 ? 'Authorization' : _ref$header;\n\n  var tokenRefreshInProgress = null;\n  return function (next) {\n    return /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(req) {\n        var token, _res;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return (0, _utils.isFunction)(tokenOrThunk) ? tokenOrThunk(req) : tokenOrThunk;\n\n              case 3:\n                token = _context.sent;\n\n                if (!(!token && tokenRefreshPromise && !allowEmptyToken)) {\n                  _context.next = 6;\n                  break;\n                }\n\n                throw new RRNLAuthMiddlewareError('Empty token');\n\n              case 6:\n                if (token) {\n                  req.fetchOpts.headers[header] = \"\".concat(prefix).concat(token);\n                }\n\n                _context.next = 9;\n                return next(req);\n\n              case 9:\n                _res = _context.sent;\n                return _context.abrupt(\"return\", _res);\n\n              case 13:\n                _context.prev = 13;\n                _context.t0 = _context[\"catch\"](0);\n\n                if (!(_context.t0 && tokenRefreshPromise)) {\n                  _context.next = 20;\n                  break;\n                }\n\n                if (!(_context.t0.message === 'Empty token' || _context.t0.res && _context.t0.res.status === 401)) {\n                  _context.next = 20;\n                  break;\n                }\n\n                if (!tokenRefreshPromise) {\n                  _context.next = 20;\n                  break;\n                }\n\n                if (!tokenRefreshInProgress) {\n                  tokenRefreshInProgress = Promise.resolve(tokenRefreshPromise(req, _context.t0.res)).then(function (newToken) {\n                    tokenRefreshInProgress = null;\n                    return newToken;\n                  })[\"catch\"](function (err) {\n                    tokenRefreshInProgress = null;\n                    throw err;\n                  });\n                }\n\n                return _context.abrupt(\"return\", tokenRefreshInProgress.then(function (newToken) {\n                  if (!newToken && !allowEmptyToken) {\n                    throw new RRNLAuthMiddlewareError('Empty token');\n                  }\n\n                  var newReq = req.clone();\n\n                  if (newToken) {\n                    newReq.fetchOpts.headers[header] = \"\".concat(prefix).concat(newToken);\n                  } else {\n                    delete newReq.fetchOpts.headers[header];\n                  }\n\n                  return next(newReq); // re-run query with new token\n                }));\n\n              case 20:\n                throw _context.t0;\n\n              case 21:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 13]]);\n      }));\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n  };\n}","map":{"version":3,"names":["_typeof","obj","Symbol","iterator","constructor","prototype","Object","defineProperty","exports","value","RRNLAuthMiddlewareError","authMiddleware","_utils","require","_RRNLError2","_interopRequireDefault","__esModule","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","error","done","Promise","then","_asyncToGenerator","fn","self","args","arguments","apply","err","undefined","_classCallCheck","instance","Constructor","TypeError","_inherits","subClass","superClass","create","writable","configurable","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf","result","NewTarget","Reflect","construct","_possibleConstructorReturn","call","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","_RRNLError","_super","msg","_this","name","opts","_ref","tokenOrThunk","token","tokenRefreshPromise","_ref$allowEmptyToken","allowEmptyToken","_ref$prefix","prefix","_ref$header","header","tokenRefreshInProgress","next","_ref2","mark","_callee","req","_res","wrap","_callee$","_context","prev","isFunction","sent","fetchOpts","headers","concat","abrupt","t0","message","res","status","newToken","newReq","clone","stop","_x"],"sources":["/Users/anubhavgupta/Documents/react_learning/graphql-react/relay-store-learning/node_modules/react-relay-network-modern/lib/middlewares/auth.js"],"sourcesContent":["\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.RRNLAuthMiddlewareError = void 0;\nexports[\"default\"] = authMiddleware;\n\nvar _utils = require(\"../utils\");\n\nvar _RRNLError2 = _interopRequireDefault(require(\"../RRNLError\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar RRNLAuthMiddlewareError = /*#__PURE__*/function (_RRNLError) {\n  _inherits(RRNLAuthMiddlewareError, _RRNLError);\n\n  var _super = _createSuper(RRNLAuthMiddlewareError);\n\n  function RRNLAuthMiddlewareError(msg) {\n    var _this;\n\n    _classCallCheck(this, RRNLAuthMiddlewareError);\n\n    _this = _super.call(this, msg);\n    _this.name = 'RRNLAuthMiddlewareError';\n    return _this;\n  }\n\n  return RRNLAuthMiddlewareError;\n}(_RRNLError2[\"default\"]);\n\nexports.RRNLAuthMiddlewareError = RRNLAuthMiddlewareError;\n\nfunction authMiddleware(opts) {\n  var _ref = opts || {},\n      tokenOrThunk = _ref.token,\n      tokenRefreshPromise = _ref.tokenRefreshPromise,\n      _ref$allowEmptyToken = _ref.allowEmptyToken,\n      allowEmptyToken = _ref$allowEmptyToken === void 0 ? false : _ref$allowEmptyToken,\n      _ref$prefix = _ref.prefix,\n      prefix = _ref$prefix === void 0 ? 'Bearer ' : _ref$prefix,\n      _ref$header = _ref.header,\n      header = _ref$header === void 0 ? 'Authorization' : _ref$header;\n\n  var tokenRefreshInProgress = null;\n  return function (next) {\n    return /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(req) {\n        var token, _res;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return (0, _utils.isFunction)(tokenOrThunk) ? tokenOrThunk(req) : tokenOrThunk;\n\n              case 3:\n                token = _context.sent;\n\n                if (!(!token && tokenRefreshPromise && !allowEmptyToken)) {\n                  _context.next = 6;\n                  break;\n                }\n\n                throw new RRNLAuthMiddlewareError('Empty token');\n\n              case 6:\n                if (token) {\n                  req.fetchOpts.headers[header] = \"\".concat(prefix).concat(token);\n                }\n\n                _context.next = 9;\n                return next(req);\n\n              case 9:\n                _res = _context.sent;\n                return _context.abrupt(\"return\", _res);\n\n              case 13:\n                _context.prev = 13;\n                _context.t0 = _context[\"catch\"](0);\n\n                if (!(_context.t0 && tokenRefreshPromise)) {\n                  _context.next = 20;\n                  break;\n                }\n\n                if (!(_context.t0.message === 'Empty token' || _context.t0.res && _context.t0.res.status === 401)) {\n                  _context.next = 20;\n                  break;\n                }\n\n                if (!tokenRefreshPromise) {\n                  _context.next = 20;\n                  break;\n                }\n\n                if (!tokenRefreshInProgress) {\n                  tokenRefreshInProgress = Promise.resolve(tokenRefreshPromise(req, _context.t0.res)).then(function (newToken) {\n                    tokenRefreshInProgress = null;\n                    return newToken;\n                  })[\"catch\"](function (err) {\n                    tokenRefreshInProgress = null;\n                    throw err;\n                  });\n                }\n\n                return _context.abrupt(\"return\", tokenRefreshInProgress.then(function (newToken) {\n                  if (!newToken && !allowEmptyToken) {\n                    throw new RRNLAuthMiddlewareError('Empty token');\n                  }\n\n                  var newReq = req.clone();\n\n                  if (newToken) {\n                    newReq.fetchOpts.headers[header] = \"\".concat(prefix).concat(newToken);\n                  } else {\n                    delete newReq.fetchOpts.headers[header];\n                  }\n\n                  return next(newReq); // re-run query with new token\n                }));\n\n              case 20:\n                throw _context.t0;\n\n              case 21:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 13]]);\n      }));\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n  };\n}"],"mappings":"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"},"metadata":{},"sourceType":"script"}