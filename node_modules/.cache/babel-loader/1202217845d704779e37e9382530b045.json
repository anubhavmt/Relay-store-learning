{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = errorMiddleware;\n\nvar _RelayRequest = _interopRequireDefault(require(\"../RelayRequest\"));\n\nvar _RelayRequestBatch = _interopRequireDefault(require(\"../RelayRequestBatch\"));\n\nvar _excluded = [\"message\", \"stack\"];\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction errorMiddleware(options) {\n  var opts = options || {};\n  var logger = opts.logger || console.error.bind(console);\n  var prefix = opts.prefix || '[RELAY-NETWORK] GRAPHQL SERVER ERROR:\\n\\n';\n  var disableServerMiddlewareTip = opts.disableServerMiddlewareTip || false;\n\n  function displayErrors(errors, reqRes) {\n    return errors.forEach(function (error) {\n      var message = error.message,\n          stack = error.stack,\n          rest = _objectWithoutProperties(error, _excluded);\n\n      var msg = \"\".concat(prefix);\n      var fmt = [];\n\n      if (stack && Array.isArray(stack)) {\n        msg = \"\".concat(msg, \"%c\").concat(stack.shift(), \"\\n%c\").concat(stack.join('\\n'));\n        fmt.push('font-weight: bold;', 'font-weight: normal;');\n      } else {\n        msg = \"\".concat(msg, \"%c\").concat(message, \" %c\");\n        fmt.push('font-weight: bold;', 'font-weight: normal;');\n      }\n\n      if (rest && Object.keys(rest).length) {\n        msg = \"\".concat(msg, \"\\n  %O\");\n        fmt.push(rest);\n      }\n\n      msg = \"\".concat(msg, \"\\n\\n%cRequest Response data:\\n  %c%O\");\n      fmt.push('font-weight: bold;', 'font-weight: normal;', reqRes);\n\n      if (!stack && !disableServerMiddlewareTip) {\n        msg = \"\".concat(msg, \"\\n\\n%cNotice:%c\").concat(noticeAbsentStack());\n        fmt.push('font-weight: bold;', 'font-weight: normal;');\n      }\n\n      logger.apply(void 0, [\"\".concat(msg, \"\\n\\n\")].concat(fmt));\n    });\n  }\n\n  return function (next) {\n    return function (req) {\n      return next(req).then(function (res) {\n        if (req instanceof _RelayRequest[\"default\"]) {\n          if (Array.isArray(res.errors)) {\n            displayErrors(res.errors, {\n              req: req,\n              res: res\n            });\n          }\n        } else if (req instanceof _RelayRequestBatch[\"default\"]) {\n          if (Array.isArray(res.json)) {\n            res.json.forEach(function (payload) {\n              if (Array.isArray(payload.errors)) {\n                displayErrors(payload.errors, {\n                  req: req,\n                  res: res\n                });\n              }\n            });\n          }\n        }\n\n        return res;\n      });\n    };\n  };\n}\n\nfunction noticeAbsentStack() {\n  return \"\\n    If you using 'express-graphql', you may get server stack-trace for error.\\n    Just tune 'formatError' to return 'stack' with stack-trace:\\n\\n    import graphqlHTTP from 'express-graphql';\\n\\n    const graphQLMiddleware = graphqlHTTP({\\n      schema: myGraphQLSchema,\\n      formatError: (error) => ({\\n        message: error.message,\\n        stack: process.env\\u200B.NODE_ENV === 'development' ? error.stack.split('\\\\n') : null,\\n      })\\n    });\\n\\n    app.use('/graphql', graphQLMiddleware);\";\n}","map":{"version":3,"names":["Object","defineProperty","exports","value","errorMiddleware","_RelayRequest","_interopRequireDefault","require","_RelayRequestBatch","_excluded","obj","__esModule","_objectWithoutProperties","source","excluded","target","_objectWithoutPropertiesLoose","key","i","getOwnPropertySymbols","sourceSymbolKeys","length","indexOf","prototype","propertyIsEnumerable","call","sourceKeys","keys","options","opts","logger","console","error","bind","prefix","disableServerMiddlewareTip","displayErrors","errors","reqRes","forEach","message","stack","rest","msg","concat","fmt","Array","isArray","shift","join","push","noticeAbsentStack","apply","next","req","then","res","json","payload"],"sources":["/Users/anubhavgupta/Documents/react_learning/graphql-react/relay-store-learning/node_modules/react-relay-network-modern/lib/middlewares/error.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = errorMiddleware;\n\nvar _RelayRequest = _interopRequireDefault(require(\"../RelayRequest\"));\n\nvar _RelayRequestBatch = _interopRequireDefault(require(\"../RelayRequestBatch\"));\n\nvar _excluded = [\"message\", \"stack\"];\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction errorMiddleware(options) {\n  var opts = options || {};\n  var logger = opts.logger || console.error.bind(console);\n  var prefix = opts.prefix || '[RELAY-NETWORK] GRAPHQL SERVER ERROR:\\n\\n';\n  var disableServerMiddlewareTip = opts.disableServerMiddlewareTip || false;\n\n  function displayErrors(errors, reqRes) {\n    return errors.forEach(function (error) {\n      var message = error.message,\n          stack = error.stack,\n          rest = _objectWithoutProperties(error, _excluded);\n\n      var msg = \"\".concat(prefix);\n      var fmt = [];\n\n      if (stack && Array.isArray(stack)) {\n        msg = \"\".concat(msg, \"%c\").concat(stack.shift(), \"\\n%c\").concat(stack.join('\\n'));\n        fmt.push('font-weight: bold;', 'font-weight: normal;');\n      } else {\n        msg = \"\".concat(msg, \"%c\").concat(message, \" %c\");\n        fmt.push('font-weight: bold;', 'font-weight: normal;');\n      }\n\n      if (rest && Object.keys(rest).length) {\n        msg = \"\".concat(msg, \"\\n  %O\");\n        fmt.push(rest);\n      }\n\n      msg = \"\".concat(msg, \"\\n\\n%cRequest Response data:\\n  %c%O\");\n      fmt.push('font-weight: bold;', 'font-weight: normal;', reqRes);\n\n      if (!stack && !disableServerMiddlewareTip) {\n        msg = \"\".concat(msg, \"\\n\\n%cNotice:%c\").concat(noticeAbsentStack());\n        fmt.push('font-weight: bold;', 'font-weight: normal;');\n      }\n\n      logger.apply(void 0, [\"\".concat(msg, \"\\n\\n\")].concat(fmt));\n    });\n  }\n\n  return function (next) {\n    return function (req) {\n      return next(req).then(function (res) {\n        if (req instanceof _RelayRequest[\"default\"]) {\n          if (Array.isArray(res.errors)) {\n            displayErrors(res.errors, {\n              req: req,\n              res: res\n            });\n          }\n        } else if (req instanceof _RelayRequestBatch[\"default\"]) {\n          if (Array.isArray(res.json)) {\n            res.json.forEach(function (payload) {\n              if (Array.isArray(payload.errors)) {\n                displayErrors(payload.errors, {\n                  req: req,\n                  res: res\n                });\n              }\n            });\n          }\n        }\n\n        return res;\n      });\n    };\n  };\n}\n\nfunction noticeAbsentStack() {\n  return \"\\n    If you using 'express-graphql', you may get server stack-trace for error.\\n    Just tune 'formatError' to return 'stack' with stack-trace:\\n\\n    import graphqlHTTP from 'express-graphql';\\n\\n    const graphQLMiddleware = graphqlHTTP({\\n      schema: myGraphQLSchema,\\n      formatError: (error) => ({\\n        message: error.message,\\n        stack: process.env\\u200B.NODE_ENV === 'development' ? error.stack.split('\\\\n') : null,\\n      })\\n    });\\n\\n    app.use('/graphql', graphQLMiddleware);\";\n}"],"mappings":"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"},"metadata":{},"sourceType":"script"}