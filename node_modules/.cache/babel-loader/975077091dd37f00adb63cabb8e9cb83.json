{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"/Users/anubhavgupta/Documents/react_learning/graphql-react/relay-store-learning/node_modules/@babel/runtime/regenerator/index.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = legacyBatchMiddleware;\n\nvar _utils = require(\"../utils\");\n\nvar _RelayRequestBatch = _interopRequireDefault(require(\"../RelayRequestBatch\"));\n\nvar _RelayRequest = _interopRequireDefault(require(\"../RelayRequest\"));\n\nvar _batch = require(\"./batch\");\n\nvar _excluded = [\"headersOrThunk\"];\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n} // Max out at roughly 100kb (express-graphql imposed max)\n\n\nvar DEFAULT_BATCH_SIZE = 102400;\n\nfunction legacyBatchMiddleware(options) {\n  var opts = options || {};\n  var batchTimeout = opts.batchTimeout || 0; // 0 is the same as nextTick in nodeJS\n\n  var allowMutations = opts.allowMutations || false;\n  var batchUrl = opts.batchUrl || '/graphql/batch';\n  var maxBatchSize = opts.maxBatchSize || DEFAULT_BATCH_SIZE;\n  var singleton = {};\n  var fetchOpts = {};\n  if (opts.method) fetchOpts.method = opts.method;\n  if (opts.credentials) fetchOpts.credentials = opts.credentials;\n  if (opts.mode) fetchOpts.mode = opts.mode;\n  if (opts.cache) fetchOpts.cache = opts.cache;\n  if (opts.redirect) fetchOpts.redirect = opts.redirect;\n  if (opts.headers) fetchOpts.headersOrThunk = opts.headers;\n  return function (next) {\n    return function (req) {\n      // do not batch mutations unless allowMutations = true\n      if (req.isMutation() && !allowMutations) {\n        return next(req);\n      }\n\n      if (!(req instanceof _RelayRequest[\"default\"])) {\n        throw new _batch.RRNLBatchMiddlewareError('Relay batch middleware accepts only simple RelayRequest. Did you add batchMiddleware twice?');\n      } // req with FormData can not be batched\n\n\n      if (req.isFormData()) {\n        return next(req);\n      }\n\n      return passThroughBatch(req, next, {\n        batchTimeout: batchTimeout,\n        batchUrl: batchUrl,\n        singleton: singleton,\n        maxBatchSize: maxBatchSize,\n        fetchOpts: fetchOpts\n      });\n    };\n  };\n}\n\nfunction passThroughBatch(req, next, opts) {\n  var singleton = opts.singleton;\n  var bodyLength = req.fetchOpts.body.length;\n\n  if (!bodyLength) {\n    return next(req);\n  }\n\n  if (!singleton.batcher || !singleton.batcher.acceptRequests) {\n    singleton.batcher = prepareNewBatcher(next, opts);\n  }\n\n  if (singleton.batcher.bodySize + bodyLength + 1 > opts.maxBatchSize) {\n    singleton.batcher = prepareNewBatcher(next, opts);\n  } // +1 accounts for tailing comma after joining\n\n\n  singleton.batcher.bodySize += bodyLength + 1; // queue request\n\n  return new Promise(function (resolve, reject) {\n    var relayReqId = req.getID();\n    var requestMap = singleton.batcher.requestMap;\n    var requestWrapper = {\n      req: req,\n      completeOk: function completeOk(res) {\n        requestWrapper.done = true;\n        resolve(res);\n        requestWrapper.duplicates.forEach(function (r) {\n          return r.completeOk(res);\n        });\n      },\n      completeErr: function completeErr(err) {\n        requestWrapper.done = true;\n        reject(err);\n        requestWrapper.duplicates.forEach(function (r) {\n          return r.completeErr(err);\n        });\n      },\n      done: false,\n      duplicates: []\n    };\n\n    if (requestMap[relayReqId]) {\n      /*\n        I've run into a scenario with Relay Classic where if you have 2 components\n        that make the exact same query, Relay will dedup the queries and reuse\n        the request ids but still make 2 requests. The batch code then loses track\n        of all the duplicate requests being made and never resolves or rejects\n        the duplicate requests\n        https://github.com/nodkz/react-relay-network-layer/pull/52\n      */\n      requestMap[relayReqId].duplicates.push(requestWrapper);\n    } else {\n      requestMap[relayReqId] = requestWrapper;\n    }\n  });\n}\n\nfunction prepareNewBatcher(next, opts) {\n  var batcher = {\n    bodySize: 2,\n    // account for '[]'\n    requestMap: {},\n    acceptRequests: true\n  };\n  setTimeout(function () {\n    batcher.acceptRequests = false;\n    sendRequests(batcher.requestMap, next, opts).then(function () {\n      return finalizeUncompleted(batcher.requestMap);\n    })[\"catch\"](function () {\n      return finalizeUncompleted(batcher.requestMap);\n    });\n  }, opts.batchTimeout);\n  return batcher;\n}\n\nfunction sendRequests(_x, _x2, _x3) {\n  return _sendRequests.apply(this, arguments);\n} // check that server returns responses for all requests\n\n\nfunction _sendRequests() {\n  _sendRequests = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(requestMap, next, opts) {\n    var ids, request, _res, batchRequest, url, _opts$fetchOpts, headersOrThunk, fetchOpts, headers, batchResponse;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            ids = Object.keys(requestMap);\n\n            if (!(ids.length === 1)) {\n              _context.next = 11;\n              break;\n            } // SEND AS SINGLE QUERY\n\n\n            request = requestMap[ids[0]];\n            _context.next = 5;\n            return next(request.req);\n\n          case 5:\n            _res = _context.sent;\n            request.completeOk(_res);\n            request.duplicates.forEach(function (r) {\n              return r.completeOk(_res);\n            });\n            return _context.abrupt(\"return\", _res);\n\n          case 11:\n            if (!(ids.length > 1)) {\n              _context.next = 37;\n              break;\n            } // SEND AS BATCHED QUERY\n\n\n            batchRequest = new _RelayRequestBatch[\"default\"](ids.map(function (id) {\n              return requestMap[id].req;\n            })); // $FlowFixMe\n\n            _context.next = 15;\n            return (0, _utils.isFunction)(opts.batchUrl) ? opts.batchUrl(requestMap) : opts.batchUrl;\n\n          case 15:\n            url = _context.sent;\n            batchRequest.setFetchOption('url', url);\n            _opts$fetchOpts = opts.fetchOpts, headersOrThunk = _opts$fetchOpts.headersOrThunk, fetchOpts = _objectWithoutProperties(_opts$fetchOpts, _excluded);\n            batchRequest.setFetchOptions(fetchOpts);\n\n            if (!headersOrThunk) {\n              _context.next = 24;\n              break;\n            }\n\n            _context.next = 22;\n            return (0, _utils.isFunction)(headersOrThunk) ? headersOrThunk(batchRequest) : headersOrThunk;\n\n          case 22:\n            headers = _context.sent;\n            batchRequest.setFetchOption('headers', headers);\n\n          case 24:\n            _context.prev = 24;\n            _context.next = 27;\n            return next(batchRequest);\n\n          case 27:\n            batchResponse = _context.sent;\n\n            if (!(!batchResponse || !Array.isArray(batchResponse.json))) {\n              _context.next = 30;\n              break;\n            }\n\n            throw new _batch.RRNLBatchMiddlewareError('Wrong response from server. Did your server support batch request?');\n\n          case 30:\n            batchResponse.json.forEach(function (payload) {\n              if (!payload) return;\n              var request = requestMap[payload.id];\n\n              if (request) {\n                var _res2 = createSingleResponse(batchResponse, payload);\n\n                request.completeOk(_res2);\n              }\n            });\n            return _context.abrupt(\"return\", batchResponse);\n\n          case 34:\n            _context.prev = 34;\n            _context.t0 = _context[\"catch\"](24);\n            ids.forEach(function (id) {\n              requestMap[id].completeErr(_context.t0);\n            });\n\n          case 37:\n            return _context.abrupt(\"return\", Promise.resolve());\n\n          case 38:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[24, 34]]);\n  }));\n  return _sendRequests.apply(this, arguments);\n}\n\nfunction finalizeUncompleted(requestMap) {\n  Object.keys(requestMap).forEach(function (id) {\n    var request = requestMap[id];\n\n    if (!request.done) {\n      request.completeErr(new _batch.RRNLBatchMiddlewareError(\"Server does not return response for request with id \".concat(id, \" \\n\") + \"Response should have following shape { \\\"id\\\": \\\"\".concat(id, \"\\\", \\\"data\\\": {} }\")));\n    }\n  });\n}\n\nfunction createSingleResponse(batchResponse, json) {\n  // Fallback for graphql-graphene and apollo-server batch responses\n  var data = json.payload || json;\n  var res = batchResponse.clone();\n  res.processJsonData(data);\n  return res;\n}","map":{"version":3,"names":["Object","defineProperty","exports","value","legacyBatchMiddleware","_utils","require","_RelayRequestBatch","_interopRequireDefault","_RelayRequest","_batch","_excluded","obj","__esModule","_objectWithoutProperties","source","excluded","target","_objectWithoutPropertiesLoose","key","i","getOwnPropertySymbols","sourceSymbolKeys","length","indexOf","prototype","propertyIsEnumerable","call","sourceKeys","keys","asyncGeneratorStep","gen","resolve","reject","_next","_throw","arg","info","error","done","Promise","then","_asyncToGenerator","fn","self","args","arguments","apply","err","undefined","DEFAULT_BATCH_SIZE","options","opts","batchTimeout","allowMutations","batchUrl","maxBatchSize","singleton","fetchOpts","method","credentials","mode","cache","redirect","headers","headersOrThunk","next","req","isMutation","RRNLBatchMiddlewareError","isFormData","passThroughBatch","bodyLength","body","batcher","acceptRequests","prepareNewBatcher","bodySize","relayReqId","getID","requestMap","requestWrapper","completeOk","res","duplicates","forEach","r","completeErr","push","setTimeout","sendRequests","finalizeUncompleted","_x","_x2","_x3","_sendRequests","mark","_callee","ids","request","_res","batchRequest","url","_opts$fetchOpts","batchResponse","wrap","_callee$","_context","prev","sent","abrupt","map","id","isFunction","setFetchOption","setFetchOptions","Array","isArray","json","payload","_res2","createSingleResponse","t0","stop","concat","data","clone","processJsonData"],"sources":["/Users/anubhavgupta/Documents/react_learning/graphql-react/relay-store-learning/node_modules/react-relay-network-modern/lib/middlewares/legacyBatch.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = legacyBatchMiddleware;\n\nvar _utils = require(\"../utils\");\n\nvar _RelayRequestBatch = _interopRequireDefault(require(\"../RelayRequestBatch\"));\n\nvar _RelayRequest = _interopRequireDefault(require(\"../RelayRequest\"));\n\nvar _batch = require(\"./batch\");\n\nvar _excluded = [\"headersOrThunk\"];\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\n// Max out at roughly 100kb (express-graphql imposed max)\nvar DEFAULT_BATCH_SIZE = 102400;\n\nfunction legacyBatchMiddleware(options) {\n  var opts = options || {};\n  var batchTimeout = opts.batchTimeout || 0; // 0 is the same as nextTick in nodeJS\n\n  var allowMutations = opts.allowMutations || false;\n  var batchUrl = opts.batchUrl || '/graphql/batch';\n  var maxBatchSize = opts.maxBatchSize || DEFAULT_BATCH_SIZE;\n  var singleton = {};\n  var fetchOpts = {};\n  if (opts.method) fetchOpts.method = opts.method;\n  if (opts.credentials) fetchOpts.credentials = opts.credentials;\n  if (opts.mode) fetchOpts.mode = opts.mode;\n  if (opts.cache) fetchOpts.cache = opts.cache;\n  if (opts.redirect) fetchOpts.redirect = opts.redirect;\n  if (opts.headers) fetchOpts.headersOrThunk = opts.headers;\n  return function (next) {\n    return function (req) {\n      // do not batch mutations unless allowMutations = true\n      if (req.isMutation() && !allowMutations) {\n        return next(req);\n      }\n\n      if (!(req instanceof _RelayRequest[\"default\"])) {\n        throw new _batch.RRNLBatchMiddlewareError('Relay batch middleware accepts only simple RelayRequest. Did you add batchMiddleware twice?');\n      } // req with FormData can not be batched\n\n\n      if (req.isFormData()) {\n        return next(req);\n      }\n\n      return passThroughBatch(req, next, {\n        batchTimeout: batchTimeout,\n        batchUrl: batchUrl,\n        singleton: singleton,\n        maxBatchSize: maxBatchSize,\n        fetchOpts: fetchOpts\n      });\n    };\n  };\n}\n\nfunction passThroughBatch(req, next, opts) {\n  var singleton = opts.singleton;\n  var bodyLength = req.fetchOpts.body.length;\n\n  if (!bodyLength) {\n    return next(req);\n  }\n\n  if (!singleton.batcher || !singleton.batcher.acceptRequests) {\n    singleton.batcher = prepareNewBatcher(next, opts);\n  }\n\n  if (singleton.batcher.bodySize + bodyLength + 1 > opts.maxBatchSize) {\n    singleton.batcher = prepareNewBatcher(next, opts);\n  } // +1 accounts for tailing comma after joining\n\n\n  singleton.batcher.bodySize += bodyLength + 1; // queue request\n\n  return new Promise(function (resolve, reject) {\n    var relayReqId = req.getID();\n    var requestMap = singleton.batcher.requestMap;\n    var requestWrapper = {\n      req: req,\n      completeOk: function completeOk(res) {\n        requestWrapper.done = true;\n        resolve(res);\n        requestWrapper.duplicates.forEach(function (r) {\n          return r.completeOk(res);\n        });\n      },\n      completeErr: function completeErr(err) {\n        requestWrapper.done = true;\n        reject(err);\n        requestWrapper.duplicates.forEach(function (r) {\n          return r.completeErr(err);\n        });\n      },\n      done: false,\n      duplicates: []\n    };\n\n    if (requestMap[relayReqId]) {\n      /*\n        I've run into a scenario with Relay Classic where if you have 2 components\n        that make the exact same query, Relay will dedup the queries and reuse\n        the request ids but still make 2 requests. The batch code then loses track\n        of all the duplicate requests being made and never resolves or rejects\n        the duplicate requests\n        https://github.com/nodkz/react-relay-network-layer/pull/52\n      */\n      requestMap[relayReqId].duplicates.push(requestWrapper);\n    } else {\n      requestMap[relayReqId] = requestWrapper;\n    }\n  });\n}\n\nfunction prepareNewBatcher(next, opts) {\n  var batcher = {\n    bodySize: 2,\n    // account for '[]'\n    requestMap: {},\n    acceptRequests: true\n  };\n  setTimeout(function () {\n    batcher.acceptRequests = false;\n    sendRequests(batcher.requestMap, next, opts).then(function () {\n      return finalizeUncompleted(batcher.requestMap);\n    })[\"catch\"](function () {\n      return finalizeUncompleted(batcher.requestMap);\n    });\n  }, opts.batchTimeout);\n  return batcher;\n}\n\nfunction sendRequests(_x, _x2, _x3) {\n  return _sendRequests.apply(this, arguments);\n} // check that server returns responses for all requests\n\n\nfunction _sendRequests() {\n  _sendRequests = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(requestMap, next, opts) {\n    var ids, request, _res, batchRequest, url, _opts$fetchOpts, headersOrThunk, fetchOpts, headers, batchResponse;\n\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            ids = Object.keys(requestMap);\n\n            if (!(ids.length === 1)) {\n              _context.next = 11;\n              break;\n            }\n\n            // SEND AS SINGLE QUERY\n            request = requestMap[ids[0]];\n            _context.next = 5;\n            return next(request.req);\n\n          case 5:\n            _res = _context.sent;\n            request.completeOk(_res);\n            request.duplicates.forEach(function (r) {\n              return r.completeOk(_res);\n            });\n            return _context.abrupt(\"return\", _res);\n\n          case 11:\n            if (!(ids.length > 1)) {\n              _context.next = 37;\n              break;\n            }\n\n            // SEND AS BATCHED QUERY\n            batchRequest = new _RelayRequestBatch[\"default\"](ids.map(function (id) {\n              return requestMap[id].req;\n            })); // $FlowFixMe\n\n            _context.next = 15;\n            return (0, _utils.isFunction)(opts.batchUrl) ? opts.batchUrl(requestMap) : opts.batchUrl;\n\n          case 15:\n            url = _context.sent;\n            batchRequest.setFetchOption('url', url);\n            _opts$fetchOpts = opts.fetchOpts, headersOrThunk = _opts$fetchOpts.headersOrThunk, fetchOpts = _objectWithoutProperties(_opts$fetchOpts, _excluded);\n            batchRequest.setFetchOptions(fetchOpts);\n\n            if (!headersOrThunk) {\n              _context.next = 24;\n              break;\n            }\n\n            _context.next = 22;\n            return (0, _utils.isFunction)(headersOrThunk) ? headersOrThunk(batchRequest) : headersOrThunk;\n\n          case 22:\n            headers = _context.sent;\n            batchRequest.setFetchOption('headers', headers);\n\n          case 24:\n            _context.prev = 24;\n            _context.next = 27;\n            return next(batchRequest);\n\n          case 27:\n            batchResponse = _context.sent;\n\n            if (!(!batchResponse || !Array.isArray(batchResponse.json))) {\n              _context.next = 30;\n              break;\n            }\n\n            throw new _batch.RRNLBatchMiddlewareError('Wrong response from server. Did your server support batch request?');\n\n          case 30:\n            batchResponse.json.forEach(function (payload) {\n              if (!payload) return;\n              var request = requestMap[payload.id];\n\n              if (request) {\n                var _res2 = createSingleResponse(batchResponse, payload);\n\n                request.completeOk(_res2);\n              }\n            });\n            return _context.abrupt(\"return\", batchResponse);\n\n          case 34:\n            _context.prev = 34;\n            _context.t0 = _context[\"catch\"](24);\n            ids.forEach(function (id) {\n              requestMap[id].completeErr(_context.t0);\n            });\n\n          case 37:\n            return _context.abrupt(\"return\", Promise.resolve());\n\n          case 38:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[24, 34]]);\n  }));\n  return _sendRequests.apply(this, arguments);\n}\n\nfunction finalizeUncompleted(requestMap) {\n  Object.keys(requestMap).forEach(function (id) {\n    var request = requestMap[id];\n\n    if (!request.done) {\n      request.completeErr(new _batch.RRNLBatchMiddlewareError(\"Server does not return response for request with id \".concat(id, \" \\n\") + \"Response should have following shape { \\\"id\\\": \\\"\".concat(id, \"\\\", \\\"data\\\": {} }\")));\n    }\n  });\n}\n\nfunction createSingleResponse(batchResponse, json) {\n  // Fallback for graphql-graphene and apollo-server batch responses\n  var data = json.payload || json;\n  var res = batchResponse.clone();\n  res.processJsonData(data);\n  return res;\n}"],"mappings":"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"},"metadata":{},"sourceType":"script"}